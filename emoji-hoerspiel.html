<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üîä Emoji H√∂rspiel</title>
<link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600;700&family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #1a1a2e;
    --surface: #16213e;
    --card-hover: #1e2d45;
    --accent: #a855f7;
    --accent-glow: rgba(168, 85, 247, 0.3);
    --text: #f0f0f0;
    --text-dim: #a0a0b8;
    --correct: #34d399;
    --wrong: #f87171;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'Nunito', sans-serif;
    background: var(--bg);
    color: var(--text);
    min-height: 100vh;
    overflow-x: hidden;
  }

  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background:
      radial-gradient(ellipse at 30% 20%, rgba(168, 85, 247, 0.08) 0%, transparent 50%),
      radial-gradient(ellipse at 70% 80%, rgba(168, 85, 247, 0.05) 0%, transparent 50%);
    pointer-events: none;
    z-index: 0;
  }

  .back-btn {
    position: fixed;
    top: 20px;
    left: 20px;
    background: var(--surface);
    color: var(--text-dim);
    text-decoration: none;
    padding: 10px 18px;
    border-radius: 12px;
    font-size: 0.9rem;
    font-weight: 600;
    z-index: 10;
    border: 1px solid rgba(255,255,255,0.08);
    transition: all 0.2s ease;
  }

  .back-btn:hover {
    background: var(--card-hover);
    color: var(--text);
  }

  .container {
    position: relative;
    z-index: 1;
    max-width: 560px;
    margin: 0 auto;
    padding: 60px 20px 80px;
    text-align: center;
  }

  /* === START SCREEN === */
  #start-screen {
    animation: fadeUp 0.6s ease;
  }

  .title-emoji {
    font-size: 4rem;
    display: block;
    margin-bottom: 12px;
    animation: bounce 2s ease infinite;
  }

  h1 {
    font-family: 'Fredoka', sans-serif;
    font-size: clamp(1.8rem, 5vw, 2.6rem);
    font-weight: 700;
    margin-bottom: 8px;
    background: linear-gradient(135deg, #a855f7, #c084fc);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  .subtitle {
    color: var(--text-dim);
    font-size: 1rem;
    margin-bottom: 40px;
    line-height: 1.5;
  }

  .lang-label {
    font-family: 'Fredoka', sans-serif;
    font-size: 1.1rem;
    font-weight: 600;
    margin-bottom: 20px;
    color: var(--text);
  }

  .lang-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 14px;
    max-width: 380px;
    margin: 0 auto;
  }

  .lang-btn {
    background: var(--surface);
    border: 2px solid rgba(255,255,255,0.08);
    border-radius: 16px;
    padding: 20px 16px;
    color: var(--text);
    font-family: 'Nunito', sans-serif;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
  }

  .lang-btn .flag {
    font-size: 2.2rem;
  }

  .lang-btn:hover {
    background: var(--card-hover);
    border-color: var(--accent);
    transform: translateY(-3px);
    box-shadow: 0 8px 24px var(--accent-glow);
  }

  .lang-btn:active {
    transform: translateY(-1px) scale(0.97);
  }

  .lang-btn:disabled {
    opacity: 0.35;
    cursor: not-allowed;
    pointer-events: none;
  }

  .lang-btn .no-voice {
    font-size: 0.7rem;
    color: var(--wrong);
    font-weight: 400;
  }

  .speed-section {
    margin-top: 32px;
    max-width: 380px;
    margin-left: auto;
    margin-right: auto;
  }

  .speed-label {
    font-family: 'Fredoka', sans-serif;
    font-size: 1rem;
    font-weight: 600;
    margin-bottom: 12px;
    color: var(--text);
  }

  .speed-row {
    display: flex;
    align-items: center;
    gap: 14px;
    background: var(--surface);
    border-radius: 14px;
    padding: 14px 18px;
    border: 1px solid rgba(255,255,255,0.06);
  }

  .speed-row span {
    font-size: 0.85rem;
    color: var(--text-dim);
    white-space: nowrap;
    min-width: 40px;
  }

  .speed-row span:last-child {
    text-align: right;
  }

  .speed-value {
    font-family: 'Fredoka', sans-serif;
    font-weight: 600;
    color: var(--accent) !important;
    min-width: 50px !important;
    text-align: center !important;
  }

  input[type="range"] {
    flex: 1;
    -webkit-appearance: none;
    appearance: none;
    height: 6px;
    background: rgba(255,255,255,0.1);
    border-radius: 3px;
    outline: none;
  }

  input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 22px;
    height: 22px;
    border-radius: 50%;
    background: var(--accent);
    cursor: pointer;
    border: 2px solid white;
  }

  input[type="range"]::-moz-range-thumb {
    width: 22px;
    height: 22px;
    border-radius: 50%;
    background: var(--accent);
    cursor: pointer;
    border: 2px solid white;
  }

  /* === GAME SCREEN === */
  #game-screen {
    display: none;
  }

  .progress-bar-wrap {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 32px;
  }

  .progress-text {
    font-family: 'Fredoka', sans-serif;
    font-size: 0.9rem;
    font-weight: 600;
    color: var(--text-dim);
    white-space: nowrap;
  }

  .progress-bar {
    flex: 1;
    height: 8px;
    background: rgba(255,255,255,0.08);
    border-radius: 4px;
    overflow: hidden;
  }

  .progress-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--accent), #c084fc);
    border-radius: 4px;
    transition: width 0.4s ease;
  }

  .score-display {
    font-family: 'Fredoka', sans-serif;
    font-size: 0.9rem;
    font-weight: 600;
    color: var(--accent);
    white-space: nowrap;
  }

  .word-card {
    background: var(--surface);
    border-radius: 20px;
    padding: 28px 24px;
    margin-bottom: 28px;
    border: 1px solid rgba(255,255,255,0.06);
    animation: popIn 0.4s ease;
  }

  .word-display {
    font-family: 'Fredoka', sans-serif;
    font-size: clamp(1.8rem, 5vw, 2.4rem);
    font-weight: 700;
    margin-bottom: 16px;
    line-height: 1.3;
  }

  .speaker-row {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    flex-wrap: wrap;
  }

  .speak-btn {
    background: var(--accent);
    border: none;
    border-radius: 50%;
    width: 44px;
    height: 44px;
    font-size: 1.3rem;
    cursor: pointer;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
  }

  .speak-btn:hover {
    transform: scale(1.1);
    box-shadow: 0 4px 16px var(--accent-glow);
  }

  .speak-btn:active {
    transform: scale(0.95);
  }

  .flag-btn {
    background: rgba(255,255,255,0.06);
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 10px;
    width: 42px;
    height: 42px;
    font-size: 1.4rem;
    cursor: pointer;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .flag-btn:hover {
    background: rgba(255,255,255,0.12);
    transform: scale(1.1);
  }

  .flag-btn:active {
    transform: scale(0.95);
  }

  .flag-btn.active {
    border-color: var(--accent);
    background: rgba(168, 85, 247, 0.15);
  }

  .emoji-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 14px;
  }

  .emoji-btn {
    background: var(--surface);
    border: 2px solid rgba(255,255,255,0.08);
    border-radius: 20px;
    padding: 24px 16px;
    font-size: 3.2rem;
    cursor: pointer;
    transition: all 0.2s ease;
    line-height: 1;
  }

  .emoji-btn:hover {
    background: var(--card-hover);
    border-color: var(--accent);
    transform: scale(1.05);
  }

  .emoji-btn:active {
    transform: scale(0.97);
  }

  .emoji-btn.correct {
    background: rgba(52, 211, 153, 0.15);
    border-color: var(--correct);
    animation: popIn 0.3s ease;
  }

  .emoji-btn.wrong {
    background: rgba(248, 113, 113, 0.12);
    border-color: var(--wrong);
    opacity: 0.7;
  }

  .emoji-btn.dimmed {
    opacity: 0.4;
    pointer-events: none;
  }

  .emoji-btn:disabled {
    cursor: default;
    pointer-events: none;
  }

  .feedback {
    margin-top: 20px;
    font-family: 'Fredoka', sans-serif;
    font-size: 1.2rem;
    font-weight: 600;
    min-height: 36px;
    opacity: 0;
    transition: opacity 0.3s ease;
  }

  .feedback.show {
    opacity: 1;
  }

  .feedback.is-correct {
    color: var(--correct);
  }

  .feedback.is-wrong {
    color: var(--wrong);
  }

  /* === RESULT SCREEN === */
  #result-screen {
    display: none;
    animation: fadeUp 0.6s ease;
  }

  .result-emoji {
    font-size: 4rem;
    display: block;
    margin-bottom: 12px;
    animation: bounce 2s ease infinite;
  }

  .result-title {
    font-family: 'Fredoka', sans-serif;
    font-size: 2rem;
    font-weight: 700;
    margin-bottom: 4px;
  }

  .result-score {
    font-size: 1.1rem;
    color: var(--text-dim);
    margin-bottom: 28px;
  }

  .result-score strong {
    color: var(--accent);
    font-size: 1.3rem;
  }

  .result-list {
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin-bottom: 32px;
  }

  .result-row {
    display: flex;
    align-items: center;
    gap: 14px;
    background: var(--surface);
    border-radius: 14px;
    padding: 12px 16px;
    border: 1px solid rgba(255,255,255,0.05);
    animation: fadeUp 0.4s ease both;
  }

  .result-row .r-emoji {
    font-size: 1.8rem;
    flex-shrink: 0;
  }

  .result-row .r-word {
    flex: 1;
    text-align: left;
    font-weight: 600;
    font-size: 0.95rem;
  }

  .result-row .r-icon {
    font-size: 1.2rem;
    flex-shrink: 0;
  }

  .action-btns {
    display: flex;
    flex-direction: column;
    gap: 12px;
  }

  .btn-primary {
    background: linear-gradient(135deg, var(--accent), #c084fc);
    border: none;
    border-radius: 16px;
    padding: 16px 32px;
    color: white;
    font-family: 'Nunito', sans-serif;
    font-size: 1rem;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .btn-primary:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 24px var(--accent-glow);
  }

  .btn-primary:active {
    transform: translateY(-1px) scale(0.98);
  }

  .btn-secondary {
    background: var(--surface);
    border: 2px solid rgba(255,255,255,0.1);
    border-radius: 16px;
    padding: 14px 32px;
    color: var(--text);
    font-family: 'Nunito', sans-serif;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .btn-secondary:hover {
    background: var(--card-hover);
    border-color: var(--accent);
  }

  /* === ANIMATIONS === */
  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(24px); }
    to { opacity: 1; transform: translateY(0); }
  }

  @keyframes popIn {
    0% { opacity: 0; transform: scale(0.8); }
    70% { transform: scale(1.05); }
    100% { opacity: 1; transform: scale(1); }
  }

  @keyframes bounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-10px); }
  }

  @keyframes shakeX {
    0%, 100% { transform: translateX(0); }
    20% { transform: translateX(-6px); }
    40% { transform: translateX(6px); }
    60% { transform: translateX(-4px); }
    80% { transform: translateX(4px); }
  }

  .shake {
    animation: shakeX 0.4s ease;
  }

  /* Mobile */
  @media (max-width: 400px) {
    .emoji-btn {
      font-size: 2.5rem;
      padding: 18px 12px;
    }
    .word-display {
      font-size: 1.5rem;
    }
    .container {
      padding: 50px 16px 60px;
    }
  }

  @media (hover: none) {
    .emoji-btn:active {
      transform: scale(0.95);
    }
    .lang-btn:active {
      transform: scale(0.96);
      box-shadow: none;
    }
  }
</style>
</head>
<body>

<a class="back-btn" href="index.html">&larr; Zur√ºck</a>

<div class="container">

  <!-- START SCREEN -->
  <div id="start-screen">
    <span class="title-emoji">üîäüéØ</span>
    <h1>Emoji H√∂rspiel</h1>
    <p class="subtitle">H√∂re ein Wort und finde das passende Emoji!<br>W√§hle deine Sprache:</p>

    <div class="lang-grid" id="lang-grid">
      <button class="lang-btn" id="lang-de" onclick="startGame('de')">
        <span class="flag">üá©üá™</span> Deutsch
      </button>
      <button class="lang-btn" id="lang-en" onclick="startGame('en')">
        <span class="flag">üá¨üáß</span> English
      </button>
      <button class="lang-btn" id="lang-it" onclick="startGame('it')">
        <span class="flag">üáÆüáπ</span> Italiano
      </button>
      <button class="lang-btn" id="lang-fr" onclick="startGame('fr')">
        <span class="flag">üá´üá∑</span> Fran√ßais
      </button>
    </div>

    <div class="speed-section">
      <div class="speed-label">üê¢ Sprechgeschwindigkeit üêá</div>
      <div class="speed-row">
        <span>Langsam</span>
        <input type="range" id="speed-slider" min="0.3" max="1.0" step="0.1" value="0.6">
        <span>Normal</span>
      </div>
    </div>
  </div>

  <!-- GAME SCREEN -->
  <div id="game-screen">
    <div class="progress-bar-wrap">
      <span class="progress-text" id="progress-text">1 / 10</span>
      <div class="progress-bar">
        <div class="progress-fill" id="progress-fill" style="width:10%"></div>
      </div>
      <span class="score-display" id="score-display">‚≠ê 0</span>
    </div>

    <div class="word-card" id="word-card">
      <div class="word-display" id="word-display"></div>
      <div class="speaker-row">
        <button class="speak-btn" id="speak-main" title="Nochmal anh√∂ren">üîä</button>
        <button class="flag-btn" data-lang="de" title="Deutsch">üá©üá™</button>
        <button class="flag-btn" data-lang="en" title="English">üá¨üáß</button>
        <button class="flag-btn" data-lang="it" title="Italiano">üáÆüáπ</button>
        <button class="flag-btn" data-lang="fr" title="Fran√ßais">üá´üá∑</button>
      </div>
    </div>

    <div class="emoji-grid" id="emoji-grid"></div>

    <div class="feedback" id="feedback"></div>
  </div>

  <!-- RESULT SCREEN -->
  <div id="result-screen">
    <span class="result-emoji" id="result-emoji"></span>
    <div class="result-title" id="result-title"></div>
    <div class="result-score" id="result-score"></div>
    <div class="result-list" id="result-list"></div>
    <div class="action-btns">
      <button class="btn-primary" id="btn-replay">üîÑ Nochmal spielen</button>
      <button class="btn-secondary" id="btn-change-lang">üåç Andere Sprache w√§hlen</button>
    </div>
  </div>

</div>

<script>
// === WORD DATA ===
const WORDS = [
  // === Tiere ===
  { emoji: "üê∂", de: "Hund", en: "Dog", it: "Cane", fr: "Chien" },
  { emoji: "üê±", de: "Katze", en: "Cat", it: "Gatto", fr: "Chat" },
  { emoji: "üêü", de: "Fisch", en: "Fish", it: "Pesce", fr: "Poisson" },
  { emoji: "üê¶", de: "Vogel", en: "Bird", it: "Uccello", fr: "Oiseau" },
  { emoji: "üê¥", de: "Pferd", en: "Horse", it: "Cavallo", fr: "Cheval" },
  { emoji: "üêÑ", de: "Kuh", en: "Cow", it: "Mucca", fr: "Vache" },
  { emoji: "üê∑", de: "Schwein", en: "Pig", it: "Maiale", fr: "Cochon" },
  { emoji: "üê∏", de: "Frosch", en: "Frog", it: "Rana", fr: "Grenouille" },
  { emoji: "üê¢", de: "Schildkr√∂te", en: "Turtle", it: "Tartaruga", fr: "Tortue" },
  { emoji: "ü¶Å", de: "L√∂we", en: "Lion", it: "Leone", fr: "Lion" },
  { emoji: "üêò", de: "Elefant", en: "Elephant", it: "Elefante", fr: "√âl√©phant" },
  { emoji: "ü¶ã", de: "Schmetterling", en: "Butterfly", it: "Farfalla", fr: "Papillon" },
  { emoji: "üê≠", de: "Maus", en: "Mouse", it: "Topo", fr: "Souris" },
  { emoji: "üê∞", de: "Hase", en: "Rabbit", it: "Coniglio", fr: "Lapin" },
  { emoji: "üêª", de: "B√§r", en: "Bear", it: "Orso", fr: "Ours" },
  { emoji: "üê∫", de: "Wolf", en: "Wolf", it: "Lupo", fr: "Loup" },
  { emoji: "ü¶ä", de: "Fuchs", en: "Fox", it: "Volpe", fr: "Renard" },
  { emoji: "üêß", de: "Pinguin", en: "Penguin", it: "Pinguino", fr: "Pingouin" },
  { emoji: "ü¶Ö", de: "Adler", en: "Eagle", it: "Aquila", fr: "Aigle" },
  { emoji: "ü¶Ü", de: "Ente", en: "Duck", it: "Anatra", fr: "Canard" },
  { emoji: "ü¶â", de: "Eule", en: "Owl", it: "Gufo", fr: "Hibou" },
  { emoji: "üêç", de: "Schlange", en: "Snake", it: "Serpente", fr: "Serpent" },
  { emoji: "üêä", de: "Krokodil", en: "Crocodile", it: "Coccodrillo", fr: "Crocodile" },
  { emoji: "ü¶à", de: "Hai", en: "Shark", it: "Squalo", fr: "Requin" },
  { emoji: "üêã", de: "Wal", en: "Whale", it: "Balena", fr: "Baleine" },
  { emoji: "üê¨", de: "Delfin", en: "Dolphin", it: "Delfino", fr: "Dauphin" },
  { emoji: "ü¶Ä", de: "Krabbe", en: "Crab", it: "Granchio", fr: "Crabe" },
  { emoji: "üêô", de: "Krake", en: "Octopus", it: "Polpo", fr: "Pieuvre" },
  { emoji: "üêå", de: "Schnecke", en: "Snail", it: "Lumaca", fr: "Escargot" },
  { emoji: "üêù", de: "Biene", en: "Bee", it: "Ape", fr: "Abeille" },
  { emoji: "üêû", de: "Marienk√§fer", en: "Ladybug", it: "Coccinella", fr: "Coccinelle" },
  { emoji: "üï∑Ô∏è", de: "Spinne", en: "Spider", it: "Ragno", fr: "Araign√©e" },
  { emoji: "ü¶é", de: "Eidechse", en: "Lizard", it: "Lucertola", fr: "L√©zard" },
  { emoji: "üê´", de: "Kamel", en: "Camel", it: "Cammello", fr: "Chameau" },
  { emoji: "ü¶í", de: "Giraffe", en: "Giraffe", it: "Giraffa", fr: "Girafe" },
  { emoji: "ü¶ì", de: "Zebra", en: "Zebra", it: "Zebra", fr: "Z√®bre" },
  { emoji: "ü¶î", de: "Igel", en: "Hedgehog", it: "Riccio", fr: "H√©risson" },
  { emoji: "üêøÔ∏è", de: "Eichh√∂rnchen", en: "Squirrel", it: "Scoiattolo", fr: "√âcureuil" },
  { emoji: "ü¶©", de: "Flamingo", en: "Flamingo", it: "Fenicottero", fr: "Flamant" },
  { emoji: "ü¶ú", de: "Papagei", en: "Parrot", it: "Pappagallo", fr: "Perroquet" },
  { emoji: "üêì", de: "Hahn", en: "Rooster", it: "Gallo", fr: "Coq" },
  { emoji: "ü¶É", de: "Truthahn", en: "Turkey", it: "Tacchino", fr: "Dinde" },
  { emoji: "üêë", de: "Schaf", en: "Sheep", it: "Pecora", fr: "Mouton" },
  { emoji: "üêê", de: "Ziege", en: "Goat", it: "Capra", fr: "Ch√®vre" },
  { emoji: "ü¶å", de: "Hirsch", en: "Deer", it: "Cervo", fr: "Cerf" },
  { emoji: "üêÄ", de: "Ratte", en: "Rat", it: "Ratto", fr: "Rat" },
  { emoji: "ü¶≠", de: "Robbe", en: "Seal", it: "Foca", fr: "Phoque" },
  { emoji: "ü¶¶", de: "Otter", en: "Otter", it: "Lontra", fr: "Loutre" },
  { emoji: "ü¶•", de: "Faultier", en: "Sloth", it: "Bradipo", fr: "Paresseux" },
  { emoji: "üêÉ", de: "B√ºffel", en: "Buffalo", it: "Bufalo", fr: "Buffle" },
  { emoji: "ü¶ç", de: "Gorilla", en: "Gorilla", it: "Gorilla", fr: "Gorille" },
  { emoji: "üêí", de: "Affe", en: "Monkey", it: "Scimmia", fr: "Singe" },
  { emoji: "ü¶á", de: "Fledermaus", en: "Bat", it: "Pipistrello", fr: "Chauve-souris" },
  { emoji: "üê≥", de: "Blauwal", en: "Blue whale", it: "Balenottera", fr: "Baleine bleue" },
  // === Obst & Gem√ºse ===
  { emoji: "üçé", de: "Apfel", en: "Apple", it: "Mela", fr: "Pomme" },
  { emoji: "üçå", de: "Banane", en: "Banana", it: "Banana", fr: "Banane" },
  { emoji: "üçá", de: "Traube", en: "Grape", it: "Uva", fr: "Raisin" },
  { emoji: "üçä", de: "Orange", en: "Orange", it: "Arancia", fr: "Orange" },
  { emoji: "üçì", de: "Erdbeere", en: "Strawberry", it: "Fragola", fr: "Fraise" },
  { emoji: "üçâ", de: "Wassermelone", en: "Watermelon", it: "Anguria", fr: "Past√®que" },
  { emoji: "ü•ï", de: "Karotte", en: "Carrot", it: "Carota", fr: "Carotte" },
  { emoji: "üçã", de: "Zitrone", en: "Lemon", it: "Limone", fr: "Citron" },
  { emoji: "üçê", de: "Birne", en: "Pear", it: "Pera", fr: "Poire" },
  { emoji: "üçë", de: "Pfirsich", en: "Peach", it: "Pesca", fr: "P√™che" },
  { emoji: "üçí", de: "Kirsche", en: "Cherry", it: "Ciliegia", fr: "Cerise" },
  { emoji: "ü•ù", de: "Kiwi", en: "Kiwi", it: "Kiwi", fr: "Kiwi" },
  { emoji: "üçç", de: "Ananas", en: "Pineapple", it: "Ananas", fr: "Ananas" },
  { emoji: "ü•ë", de: "Avocado", en: "Avocado", it: "Avocado", fr: "Avocat" },
  { emoji: "üåΩ", de: "Mais", en: "Corn", it: "Mais", fr: "Ma√Øs" },
  { emoji: "ü•¶", de: "Brokkoli", en: "Broccoli", it: "Broccolo", fr: "Brocoli" },
  { emoji: "ü•í", de: "Gurke", en: "Cucumber", it: "Cetriolo", fr: "Concombre" },
  { emoji: "üçÑ", de: "Pilz", en: "Mushroom", it: "Fungo", fr: "Champignon" },
  { emoji: "üßÖ", de: "Zwiebel", en: "Onion", it: "Cipolla", fr: "Oignon" },
  { emoji: "üßÑ", de: "Knoblauch", en: "Garlic", it: "Aglio", fr: "Ail" },
  { emoji: "ü•î", de: "Kartoffel", en: "Potato", it: "Patata", fr: "Pomme de terre" },
  { emoji: "üå∂Ô∏è", de: "Chili", en: "Chili", it: "Peperoncino", fr: "Piment" },
  { emoji: "ü´ë", de: "Paprika", en: "Bell pepper", it: "Peperone", fr: "Poivron" },
  { emoji: "ü•¨", de: "Kopfsalat", en: "Lettuce", it: "Lattuga", fr: "Laitue" },
  { emoji: "ü´ê", de: "Blaubeere", en: "Blueberry", it: "Mirtillo", fr: "Myrtille" },
  { emoji: "ü•≠", de: "Mango", en: "Mango", it: "Mango", fr: "Mangue" },
  { emoji: "ü••", de: "Kokosnuss", en: "Coconut", it: "Cocco", fr: "Noix de coco" },
  // === Essen & Trinken ===
  { emoji: "üçï", de: "Pizza", en: "Pizza", it: "Pizza", fr: "Pizza" },
  { emoji: "üçî", de: "Hamburger", en: "Hamburger", it: "Hamburger", fr: "Hamburger" },
  { emoji: "üç¶", de: "Eiscreme", en: "Ice cream", it: "Gelato", fr: "Glace" },
  { emoji: "üéÇ", de: "Kuchen", en: "Cake", it: "Torta", fr: "G√¢teau" },
  { emoji: "üßÄ", de: "K√§se", en: "Cheese", it: "Formaggio", fr: "Fromage" },
  { emoji: "üçû", de: "Brot", en: "Bread", it: "Pane", fr: "Pain" },
  { emoji: "ü•ö", de: "Ei", en: "Egg", it: "Uovo", fr: "≈íuf" },
  { emoji: "ü•õ", de: "Milch", en: "Milk", it: "Latte", fr: "Lait" },
  { emoji: "‚òï", de: "Kaffee", en: "Coffee", it: "Caff√®", fr: "Caf√©" },
  { emoji: "üçµ", de: "Tee", en: "Tea", it: "T√®", fr: "Th√©" },
  { emoji: "üç™", de: "Keks", en: "Cookie", it: "Biscotto", fr: "Biscuit" },
  { emoji: "üç©", de: "Donut", en: "Donut", it: "Ciambella", fr: "Beignet" },
  { emoji: "üç´", de: "Schokolade", en: "Chocolate", it: "Cioccolato", fr: "Chocolat" },
  { emoji: "üçø", de: "Popcorn", en: "Popcorn", it: "Popcorn", fr: "Popcorn" },
  { emoji: "üåÆ", de: "Taco", en: "Taco", it: "Taco", fr: "Taco" },
  { emoji: "ü•ó", de: "Salat", en: "Salad", it: "Insalata", fr: "Salade" },
  { emoji: "üçù", de: "Spaghetti", en: "Spaghetti", it: "Spaghetti", fr: "Spaghetti" },
  { emoji: "üç£", de: "Sushi", en: "Sushi", it: "Sushi", fr: "Sushi" },
  { emoji: "ü•ê", de: "Croissant", en: "Croissant", it: "Cornetto", fr: "Croissant" },
  { emoji: "üßÅ", de: "Muffin", en: "Cupcake", it: "Muffin", fr: "Muffin" },
  { emoji: "üç∞", de: "Torte", en: "Pie", it: "Fetta di torta", fr: "Tarte" },
  { emoji: "üßÉ", de: "Saft", en: "Juice", it: "Succo", fr: "Jus" },
  { emoji: "üçØ", de: "Honig", en: "Honey", it: "Miele", fr: "Miel" },
  { emoji: "ü•®", de: "Brezel", en: "Pretzel", it: "Pretzel", fr: "Bretzel" },
  // === Natur & Wetter ===
  { emoji: "üå≥", de: "Baum", en: "Tree", it: "Albero", fr: "Arbre" },
  { emoji: "üåª", de: "Sonnenblume", en: "Sunflower", it: "Girasole", fr: "Tournesol" },
  { emoji: "‚≠ê", de: "Stern", en: "Star", it: "Stella", fr: "√âtoile" },
  { emoji: "üåô", de: "Mond", en: "Moon", it: "Luna", fr: "Lune" },
  { emoji: "‚òÄÔ∏è", de: "Sonne", en: "Sun", it: "Sole", fr: "Soleil" },
  { emoji: "üåßÔ∏è", de: "Regen", en: "Rain", it: "Pioggia", fr: "Pluie" },
  { emoji: "‚ùÑÔ∏è", de: "Schnee", en: "Snow", it: "Neve", fr: "Neige" },
  { emoji: "üåà", de: "Regenbogen", en: "Rainbow", it: "Arcobaleno", fr: "Arc-en-ciel" },
  { emoji: "üåä", de: "Welle", en: "Wave", it: "Onda", fr: "Vague" },
  { emoji: "üåã", de: "Vulkan", en: "Volcano", it: "Vulcano", fr: "Volcan" },
  { emoji: "‚õ∞Ô∏è", de: "Berg", en: "Mountain", it: "Montagna", fr: "Montagne" },
  { emoji: "üèùÔ∏è", de: "Insel", en: "Island", it: "Isola", fr: "√éle" },
  { emoji: "üåµ", de: "Kaktus", en: "Cactus", it: "Cactus", fr: "Cactus" },
  { emoji: "üçÄ", de: "Kleeblatt", en: "Clover", it: "Trifoglio", fr: "Tr√®fle" },
  { emoji: "üåπ", de: "Rose", en: "Rose", it: "Rosa", fr: "Rose" },
  { emoji: "üå∑", de: "Tulpe", en: "Tulip", it: "Tulipano", fr: "Tulipe" },
  { emoji: "üå∏", de: "Kirschbl√ºte", en: "Cherry blossom", it: "Fiore di ciliegio", fr: "Fleur de cerisier" },
  { emoji: "üçÇ", de: "Herbstblatt", en: "Fallen leaf", it: "Foglia", fr: "Feuille" },
  { emoji: "üåæ", de: "Weizen", en: "Wheat", it: "Grano", fr: "Bl√©" },
  { emoji: "‚ö°", de: "Blitz", en: "Lightning", it: "Fulmine", fr: "√âclair" },
  { emoji: "üå™Ô∏è", de: "Tornado", en: "Tornado", it: "Tornado", fr: "Tornade" },
  { emoji: "üçÅ", de: "Ahornblatt", en: "Maple leaf", it: "Foglia d'acero", fr: "Feuille d'√©rable" },
  // === Geb√§ude & Orte ===
  { emoji: "üè†", de: "Haus", en: "House", it: "Casa", fr: "Maison" },
  { emoji: "üè∞", de: "Schloss", en: "Castle", it: "Castello", fr: "Ch√¢teau" },
  { emoji: "‚õ™", de: "Kirche", en: "Church", it: "Chiesa", fr: "√âglise" },
  { emoji: "üè•", de: "Krankenhaus", en: "Hospital", it: "Ospedale", fr: "H√¥pital" },
  { emoji: "üè´", de: "Schule", en: "School", it: "Scuola", fr: "√âcole" },
  { emoji: "üè™", de: "Laden", en: "Shop", it: "Negozio", fr: "Magasin" },
  { emoji: "‚õ∫", de: "Zelt", en: "Tent", it: "Tenda", fr: "Tente" },
  { emoji: "üóº", de: "Turm", en: "Tower", it: "Torre", fr: "Tour" },
  { emoji: "üåâ", de: "Br√ºcke", en: "Bridge", it: "Ponte", fr: "Pont" },
  { emoji: "üèüÔ∏è", de: "Stadion", en: "Stadium", it: "Stadio", fr: "Stade" },
  // === Fahrzeuge & Transport ===
  { emoji: "üöó", de: "Auto", en: "Car", it: "Macchina", fr: "Voiture" },
  { emoji: "‚úàÔ∏è", de: "Flugzeug", en: "Airplane", it: "Aereo", fr: "Avion" },
  { emoji: "üö¢", de: "Schiff", en: "Ship", it: "Nave", fr: "Navire" },
  { emoji: "üö≤", de: "Fahrrad", en: "Bicycle", it: "Bicicletta", fr: "V√©lo" },
  { emoji: "üöÄ", de: "Rakete", en: "Rocket", it: "Razzo", fr: "Fus√©e" },
  { emoji: "üöÇ", de: "Zug", en: "Train", it: "Treno", fr: "Train" },
  { emoji: "üöÅ", de: "Hubschrauber", en: "Helicopter", it: "Elicottero", fr: "H√©licopt√®re" },
  { emoji: "üöå", de: "Bus", en: "Bus", it: "Autobus", fr: "Bus" },
  { emoji: "üèçÔ∏è", de: "Motorrad", en: "Motorcycle", it: "Motocicletta", fr: "Moto" },
  { emoji: "üõ¥", de: "Roller", en: "Scooter", it: "Monopattino", fr: "Trottinette" },
  { emoji: "üöú", de: "Traktor", en: "Tractor", it: "Trattore", fr: "Tracteur" },
  { emoji: "üöí", de: "Feuerwehr", en: "Fire truck", it: "Pompieri", fr: "Pompiers" },
  { emoji: "üöë", de: "Krankenwagen", en: "Ambulance", it: "Ambulanza", fr: "Ambulance" },
  { emoji: "üöì", de: "Polizeiauto", en: "Police car", it: "Polizia", fr: "Voiture de police" },
  { emoji: "‚õµ", de: "Segelboot", en: "Sailboat", it: "Barca a vela", fr: "Voilier" },
  { emoji: "üõ∂", de: "Kanu", en: "Canoe", it: "Canoa", fr: "Cano√´" },
  // === Sport & Freizeit ===
  { emoji: "‚öΩ", de: "Fussball", en: "Soccer ball", it: "Pallone", fr: "Ballon" },
  { emoji: "üèÄ", de: "Basketball", en: "Basketball", it: "Pallacanestro", fr: "Basket" },
  { emoji: "üéæ", de: "Tennis", en: "Tennis", it: "Tennis", fr: "Tennis" },
  { emoji: "üèà", de: "Football", en: "Football", it: "Football", fr: "Football" },
  { emoji: "‚õ∑Ô∏è", de: "Skifahrer", en: "Skier", it: "Sciatore", fr: "Skieur" },
  { emoji: "üèä", de: "Schwimmer", en: "Swimmer", it: "Nuotatore", fr: "Nageur" },
  { emoji: "üé£", de: "Angeln", en: "Fishing", it: "Pesca", fr: "P√™che" },
  { emoji: "üèÑ", de: "Surfer", en: "Surfer", it: "Surfista", fr: "Surfeur" },
  { emoji: "üéØ", de: "Zielscheibe", en: "Target", it: "Bersaglio", fr: "Cible" },
  { emoji: "ü•ä", de: "Boxhandschuh", en: "Boxing glove", it: "Guantone", fr: "Gant de boxe" },
  { emoji: "üèì", de: "Tischtennis", en: "Table tennis", it: "Ping pong", fr: "Ping-pong" },
  { emoji: "üé≥", de: "Bowling", en: "Bowling", it: "Bowling", fr: "Bowling" },
  // === Musik & Kunst ===
  { emoji: "üé∏", de: "Gitarre", en: "Guitar", it: "Chitarra", fr: "Guitare" },
  { emoji: "üéπ", de: "Klavier", en: "Piano", it: "Pianoforte", fr: "Piano" },
  { emoji: "ü•Å", de: "Trommel", en: "Drum", it: "Tamburo", fr: "Tambour" },
  { emoji: "üé∫", de: "Trompete", en: "Trumpet", it: "Tromba", fr: "Trompette" },
  { emoji: "üéª", de: "Geige", en: "Violin", it: "Violino", fr: "Violon" },
  { emoji: "üé®", de: "Palette", en: "Palette", it: "Tavolozza", fr: "Palette" },
  { emoji: "üé≠", de: "Theater", en: "Theater", it: "Teatro", fr: "Th√©√¢tre" },
  { emoji: "üé¨", de: "Filmklappe", en: "Clapperboard", it: "Ciak", fr: "Clap" },
  // === Objekte & Alltag ===
  { emoji: "üìö", de: "B√ºcher", en: "Books", it: "Libri", fr: "Livres" },
  { emoji: "üîë", de: "Schl√ºssel", en: "Key", it: "Chiave", fr: "Cl√©" },
  { emoji: "üí°", de: "Gl√ºhbirne", en: "Light bulb", it: "Lampadina", fr: "Ampoule" },
  { emoji: "üéà", de: "Luftballon", en: "Balloon", it: "Palloncino", fr: "Ballon" },
  { emoji: "üéÅ", de: "Geschenk", en: "Gift", it: "Regalo", fr: "Cadeau" },
  { emoji: "üëë", de: "Krone", en: "Crown", it: "Corona", fr: "Couronne" },
  { emoji: "üíé", de: "Diamant", en: "Diamond", it: "Diamante", fr: "Diamant" },
  { emoji: "üîî", de: "Glocke", en: "Bell", it: "Campana", fr: "Cloche" },
  { emoji: "üïê", de: "Uhr", en: "Clock", it: "Orologio", fr: "Horloge" },
  { emoji: "üåç", de: "Erde", en: "Earth", it: "Terra", fr: "Terre" },
  { emoji: "üî®", de: "Hammer", en: "Hammer", it: "Martello", fr: "Marteau" },
  { emoji: "‚úÇÔ∏è", de: "Schere", en: "Scissors", it: "Forbici", fr: "Ciseaux" },
  { emoji: "üìé", de: "B√ºroklammer", en: "Paper clip", it: "Graffetta", fr: "Trombone" },
  { emoji: "üìè", de: "Lineal", en: "Ruler", it: "Righello", fr: "R√®gle" },
  { emoji: "üñäÔ∏è", de: "Stift", en: "Pen", it: "Penna", fr: "Stylo" },
  { emoji: "üì∑", de: "Kamera", en: "Camera", it: "Fotocamera", fr: "Appareil photo" },
  { emoji: "üíª", de: "Laptop", en: "Laptop", it: "Portatile", fr: "Ordinateur" },
  { emoji: "üì±", de: "Handy", en: "Phone", it: "Cellulare", fr: "T√©l√©phone" },
  { emoji: "üî¶", de: "Taschenlampe", en: "Flashlight", it: "Torcia", fr: "Lampe torche" },
  { emoji: "üß≤", de: "Magnet", en: "Magnet", it: "Magnete", fr: "Aimant" },
  { emoji: "‚è∞", de: "Wecker", en: "Alarm clock", it: "Sveglia", fr: "R√©veil" },
  { emoji: "üß∏", de: "Teddyb√§r", en: "Teddy bear", it: "Orsacchiotto", fr: "Nounours" },
  { emoji: "üéí", de: "Rucksack", en: "Backpack", it: "Zaino", fr: "Sac √† dos" },
  { emoji: "üëì", de: "Brille", en: "Glasses", it: "Occhiali", fr: "Lunettes" },
  { emoji: "üß§", de: "Handschuh", en: "Glove", it: "Guanto", fr: "Gant" },
  { emoji: "üß£", de: "Schal", en: "Scarf", it: "Sciarpa", fr: "√âcharpe" },
  { emoji: "üëí", de: "Hut", en: "Hat", it: "Cappello", fr: "Chapeau" },
  { emoji: "üëü", de: "Schuh", en: "Shoe", it: "Scarpa", fr: "Chaussure" },
  { emoji: "üß¶", de: "Socke", en: "Sock", it: "Calzino", fr: "Chaussette" },
  { emoji: "üëó", de: "Kleid", en: "Dress", it: "Vestito", fr: "Robe" },
  { emoji: "üß•", de: "Mantel", en: "Coat", it: "Cappotto", fr: "Manteau" },
  { emoji: "üëï", de: "T-Shirt", en: "T-Shirt", it: "Maglietta", fr: "T-Shirt" },
  { emoji: "üé©", de: "Zylinder", en: "Top hat", it: "Cilindro", fr: "Haut-de-forme" },
  { emoji: "‚òÇÔ∏è", de: "Regenschirm", en: "Umbrella", it: "Ombrello", fr: "Parapluie" },
  { emoji: "üóùÔ∏è", de: "Alter Schl√ºssel", en: "Old key", it: "Vecchia chiave", fr: "Vieille cl√©" },
  { emoji: "üïØÔ∏è", de: "Kerze", en: "Candle", it: "Candela", fr: "Bougie" },
  { emoji: "üßπ", de: "Besen", en: "Broom", it: "Scopa", fr: "Balai" },
  { emoji: "ü™£", de: "Eimer", en: "Bucket", it: "Secchio", fr: "Seau" },
  { emoji: "üß¥", de: "Seife", en: "Soap", it: "Sapone", fr: "Savon" },
  { emoji: "ü™û", de: "Spiegel", en: "Mirror", it: "Specchio", fr: "Miroir" },
  { emoji: "üõèÔ∏è", de: "Bett", en: "Bed", it: "Letto", fr: "Lit" },
  { emoji: "ü™ë", de: "Stuhl", en: "Chair", it: "Sedia", fr: "Chaise" },
  { emoji: "üö™", de: "T√ºr", en: "Door", it: "Porta", fr: "Porte" },
  { emoji: "ü™ü", de: "Fenster", en: "Window", it: "Finestra", fr: "Fen√™tre" },
  // === K√∂rper & Gesundheit ===
  { emoji: "‚ù§Ô∏è", de: "Herz", en: "Heart", it: "Cuore", fr: "C≈ìur" },
  { emoji: "üß†", de: "Gehirn", en: "Brain", it: "Cervello", fr: "Cerveau" },
  { emoji: "üëÅÔ∏è", de: "Auge", en: "Eye", it: "Occhio", fr: "≈íil" },
  { emoji: "üëÇ", de: "Ohr", en: "Ear", it: "Orecchio", fr: "Oreille" },
  { emoji: "üëÉ", de: "Nase", en: "Nose", it: "Naso", fr: "Nez" },
  { emoji: "üëÑ", de: "Mund", en: "Mouth", it: "Bocca", fr: "Bouche" },
  { emoji: "ü¶∑", de: "Zahn", en: "Tooth", it: "Dente", fr: "Dent" },
  { emoji: "üí™", de: "Muskel", en: "Muscle", it: "Muscolo", fr: "Muscle" },
  { emoji: "ü¶∂", de: "Fuss", en: "Foot", it: "Piede", fr: "Pied" },
  { emoji: "‚úã", de: "Hand", en: "Hand", it: "Mano", fr: "Main" },
  // === Berufe & Menschen ===
  { emoji: "üë©‚Äçüöí", de: "Feuerwehrfrau", en: "Firefighter", it: "Pompiera", fr: "Pompi√®re" },
  { emoji: "üë®‚Äçüç≥", de: "Koch", en: "Chef", it: "Cuoco", fr: "Cuisinier" },
  { emoji: "üë©‚Äçüè´", de: "Lehrerin", en: "Teacher", it: "Insegnante", fr: "Enseignante" },
  { emoji: "üë®‚Äçüî¨", de: "Wissenschaftler", en: "Scientist", it: "Scienziato", fr: "Scientifique" },
  { emoji: "üë©‚ÄçüöÄ", de: "Astronautin", en: "Astronaut", it: "Astronauta", fr: "Astronaute" },
  { emoji: "üëÆ", de: "Polizist", en: "Police officer", it: "Poliziotto", fr: "Policier" },
  { emoji: "üë∑", de: "Bauarbeiter", en: "Construction worker", it: "Operaio", fr: "Ouvrier" },
  { emoji: "üë®‚Äçüåæ", de: "Bauer", en: "Farmer", it: "Contadino", fr: "Fermier" },
  { emoji: "üßë‚Äç‚úàÔ∏è", de: "Pilot", en: "Pilot", it: "Pilota", fr: "Pilote" },
  { emoji: "üë∂", de: "Baby", en: "Baby", it: "Bambino", fr: "B√©b√©" },
  // === Symbole & Sonstiges ===
  { emoji: "üéµ", de: "Musik", en: "Music", it: "Musica", fr: "Musique" },
  { emoji: "üí§", de: "Schlafen", en: "Sleep", it: "Dormire", fr: "Dormir" },
  { emoji: "üî•", de: "Feuer", en: "Fire", it: "Fuoco", fr: "Feu" },
  { emoji: "üíß", de: "Wasser", en: "Water", it: "Acqua", fr: "Eau" },
  { emoji: "üéÉ", de: "K√ºrbis", en: "Pumpkin", it: "Zucca", fr: "Citrouille" },
  { emoji: "üéÑ", de: "Weihnachtsbaum", en: "Christmas tree", it: "Albero di Natale", fr: "Sapin de No√´l" },
  { emoji: "üéÖ", de: "Weihnachtsmann", en: "Santa Claus", it: "Babbo Natale", fr: "P√®re No√´l" },
  { emoji: "üëª", de: "Gespenst", en: "Ghost", it: "Fantasma", fr: "Fant√¥me" },
  { emoji: "ü§ñ", de: "Roboter", en: "Robot", it: "Robot", fr: "Robot" },
  { emoji: "üëΩ", de: "Alien", en: "Alien", it: "Alieno", fr: "Extraterrestre" },
  { emoji: "üßô", de: "Zauberer", en: "Wizard", it: "Mago", fr: "Sorcier" },
  { emoji: "üßú‚Äç‚ôÄÔ∏è", de: "Meerjungfrau", en: "Mermaid", it: "Sirena", fr: "Sir√®ne" },
  { emoji: "ü¶∏", de: "Superheld", en: "Superhero", it: "Supereroe", fr: "Super-h√©ros" },
  { emoji: "üèÜ", de: "Pokal", en: "Trophy", it: "Trofeo", fr: "Troph√©e" },
  { emoji: "üéÆ", de: "Spielkonsole", en: "Game controller", it: "Videogioco", fr: "Manette" },
  { emoji: "üß©", de: "Puzzle", en: "Puzzle", it: "Puzzle", fr: "Puzzle" },
  { emoji: "üé≤", de: "W√ºrfel", en: "Dice", it: "Dado", fr: "D√©" },
  { emoji: "ü™Å", de: "Drachen", en: "Kite", it: "Aquilone", fr: "Cerf-volant" },
  { emoji: "üõ∏", de: "Ufo", en: "UFO", it: "UFO", fr: "OVNI" },
  { emoji: "üí∞", de: "Geldsack", en: "Money bag", it: "Sacco di soldi", fr: "Sac d'argent" },
  { emoji: "üìÆ", de: "Briefkasten", en: "Mailbox", it: "Cassetta postale", fr: "Bo√Æte aux lettres" },
  { emoji: "üó∫Ô∏è", de: "Weltkarte", en: "World map", it: "Mappamondo", fr: "Carte du monde" },
  { emoji: "üß≠", de: "Kompass", en: "Compass", it: "Bussola", fr: "Boussole" },
  { emoji: "‚öì", de: "Anker", en: "Anchor", it: "Ancora", fr: "Ancre" },
  { emoji: "üî≠", de: "Teleskop", en: "Telescope", it: "Telescopio", fr: "T√©lescope" },
  { emoji: "üî¨", de: "Mikroskop", en: "Microscope", it: "Microscopio", fr: "Microscope" },
  { emoji: "üíä", de: "Tablette", en: "Pill", it: "Pillola", fr: "Pilule" },
  { emoji: "ü©π", de: "Pflaster", en: "Bandage", it: "Cerotto", fr: "Pansement" },
];

const LANG_CODES = { de: "de-DE", en: "en-US", it: "it-IT", fr: "fr-FR" };
const ROUNDS = 20;

// === STATE ===
let lang = "";
let items = [];
let current = 0;
let score = 0;
let results = [];
let answered = false;
let availableVoices = {};

// === DOM ===
const startScreen = document.getElementById("start-screen");
const gameScreen = document.getElementById("game-screen");
const resultScreen = document.getElementById("result-screen");
const progressText = document.getElementById("progress-text");
const progressFill = document.getElementById("progress-fill");
const scoreDisplay = document.getElementById("score-display");
const wordCard = document.getElementById("word-card");
const wordDisplay = document.getElementById("word-display");
const emojiGrid = document.getElementById("emoji-grid");
const feedback = document.getElementById("feedback");
const speakMain = document.getElementById("speak-main");
const speedSlider = document.getElementById("speed-slider");

// === VOICE CHECK ===
function checkVoices() {
  const voices = speechSynthesis.getVoices();
  const langs = { de: "de", en: "en", it: "it", fr: "fr" };
  availableVoices = {};

  for (const [key, prefix] of Object.entries(langs)) {
    availableVoices[key] = voices.filter(v => v.lang.startsWith(prefix));
  }

  for (const [key, voiceList] of Object.entries(availableVoices)) {
    const btn = document.getElementById("lang-" + key);
    if (!btn) continue;
    if (voiceList.length === 0) {
      btn.disabled = true;
      if (!btn.querySelector(".no-voice")) {
        const hint = document.createElement("span");
        hint.className = "no-voice";
        hint.textContent = "Keine Stimme verf√ºgbar";
        btn.appendChild(hint);
      }
    } else {
      btn.disabled = false;
      const hint = btn.querySelector(".no-voice");
      if (hint) hint.remove();
    }
  }
}

speechSynthesis.addEventListener("voiceschanged", checkVoices);
checkVoices();

// === SPEECH ===
function getSpeed() {
  return parseFloat(speedSlider.value);
}

function speakWord(word, langCode) {
  speechSynthesis.cancel();
  const u = new SpeechSynthesisUtterance(word);
  u.lang = langCode;
  u.rate = getSpeed();
  u.pitch = 1.1;

  // Try to pick a voice that matches the language
  const prefix = langCode.substring(0, 2);
  const matching = availableVoices[prefix] || [];
  if (matching.length > 0) {
    u.voice = matching[0];
  }

  speechSynthesis.speak(u);
}

// === HELPERS ===
function shuffle(arr) {
  const a = [...arr];
  for (let i = a.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [a[i], a[j]] = [a[j], a[i]];
  }
  return a;
}

function showScreen(screen) {
  startScreen.style.display = "none";
  gameScreen.style.display = "none";
  resultScreen.style.display = "none";
  screen.style.display = "block";
}

// === GAME LOGIC ===
function startGame(selectedLang) {
  lang = selectedLang;
  items = shuffle(WORDS).slice(0, ROUNDS);
  current = 0;
  score = 0;
  results = [];
  showScreen(gameScreen);
  renderRound();
}

function renderRound() {
  answered = false;
  const item = items[current];
  const word = item[lang];

  // Progress
  progressText.textContent = `${current + 1} / ${ROUNDS}`;
  progressFill.style.width = `${((current + 1) / ROUNDS) * 100}%`;
  scoreDisplay.textContent = `‚≠ê ${score}`;

  // Word
  wordDisplay.textContent = word;
  wordCard.style.animation = "none";
  wordCard.offsetHeight; // reflow
  wordCard.style.animation = "popIn 0.4s ease";

  // Reset feedback
  feedback.className = "feedback";
  feedback.textContent = "";

  // Speak the word
  setTimeout(() => speakWord(word, LANG_CODES[lang]), 300);

  // Flag buttons - highlight active language, disable unavailable
  document.querySelectorAll(".flag-btn").forEach(btn => {
    const bLang = btn.dataset.lang;
    btn.classList.toggle("active", bLang === lang);
    const voices = availableVoices[bLang] || [];
    btn.style.opacity = voices.length === 0 ? "0.3" : "1";
    btn.style.pointerEvents = voices.length === 0 ? "none" : "auto";
  });

  // Generate decoys
  const otherEmojis = WORDS.filter(w => w.emoji !== item.emoji);
  const decoys = shuffle(otherEmojis).slice(0, 3).map(w => w.emoji);
  const options = shuffle([item.emoji, ...decoys]);

  // Render emoji buttons
  emojiGrid.innerHTML = "";
  options.forEach((emoji, i) => {
    const btn = document.createElement("button");
    btn.className = "emoji-btn";
    btn.textContent = emoji;
    btn.style.animationDelay = `${i * 0.08}s`;
    btn.style.animation = `popIn 0.3s ease ${i * 0.08}s both`;
    btn.addEventListener("click", () => handleAnswer(emoji, item.emoji, btn));
    emojiGrid.appendChild(btn);
  });
}

function handleAnswer(selected, correct, btn) {
  if (answered) return;
  answered = true;

  const isCorrect = selected === correct;

  if (isCorrect) {
    score++;
    btn.classList.add("correct");
    feedback.className = "feedback show is-correct";
    feedback.textContent = "‚úì Richtig!";
    scoreDisplay.textContent = `‚≠ê ${score}`;
  } else {
    btn.classList.add("wrong");
    btn.classList.add("shake");
    feedback.className = "feedback show is-wrong";
    feedback.textContent = `‚úó Falsch! Es war ${correct}`;
    // Highlight the correct one
    document.querySelectorAll(".emoji-btn").forEach(b => {
      if (b.textContent === correct) b.classList.add("correct");
      else if (!b.classList.contains("wrong")) b.classList.add("dimmed");
    });
  }

  // Disable all buttons
  document.querySelectorAll(".emoji-btn").forEach(b => b.disabled = true);

  results.push({
    emoji: correct,
    word: items[current][lang],
    correct: isCorrect
  });

  // Next round or results
  setTimeout(() => {
    current++;
    if (current < ROUNDS) {
      renderRound();
    } else {
      showResults();
    }
  }, 1400);
}

function showResults() {
  showScreen(resultScreen);

  const pct = Math.round((score / ROUNDS) * 100);
  let trophy, title;

  if (pct === 100) { trophy = "üèÜ"; title = "Perfekt!"; }
  else if (pct >= 80) { trophy = "üåü"; title = "Super gemacht!"; }
  else if (pct >= 60) { trophy = "üëè"; title = "Gut gemacht!"; }
  else if (pct >= 40) { trophy = "üí™"; title = "Weiter √ºben!"; }
  else { trophy = "üéØ"; title = "N√§chstes Mal besser!"; }

  document.getElementById("result-emoji").textContent = trophy;
  document.getElementById("result-title").textContent = title;
  document.getElementById("result-score").innerHTML = `Du hast <strong>${score} von ${ROUNDS}</strong> richtig`;

  const list = document.getElementById("result-list");
  list.innerHTML = "";
  results.forEach((r, i) => {
    const row = document.createElement("div");
    row.className = "result-row";
    row.style.animationDelay = `${i * 0.06}s`;
    row.innerHTML = `
      <span class="r-emoji">${r.emoji}</span>
      <span class="r-word">${r.word}</span>
      <span class="r-icon">${r.correct ? "‚úÖ" : "‚ùå"}</span>
    `;
    list.appendChild(row);
  });
}

// === EVENT LISTENERS ===
speakMain.addEventListener("click", () => {
  const item = items[current];
  if (item) speakWord(item[lang], LANG_CODES[lang]);
});

document.querySelectorAll(".flag-btn").forEach(btn => {
  btn.addEventListener("click", () => {
    const targetLang = btn.dataset.lang;
    const item = items[current];
    if (item) speakWord(item[targetLang], LANG_CODES[targetLang]);
  });
});

document.getElementById("btn-replay").addEventListener("click", () => {
  startGame(lang);
});

document.getElementById("btn-change-lang").addEventListener("click", () => {
  showScreen(startScreen);
});
</script>

</body>
</html>
